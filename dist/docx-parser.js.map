{"version":3,"sources":["webpack:///webpack/bootstrap 21a4b80348fd3e780749","webpack:///./src/XML.js","webpack:///./src/docx-parser.js","webpack:///./src/Reader.js","webpack:///./src/Prop.js","webpack:///./src/tags/Paragraph.js","webpack:///./src/tags/BaseTag.js"],"names":["XML","data","Node","oParser","DOMParser","oDOM","parseFromString","documentElement","Error","selector","el","querySelector","nodes","querySelectorAll","result","item","push","split","s","a","node","getAttribute","children","localName","textContent","window","docxparser","load","files","prop","file","promise","Promise","resolve","reject","zip","createReader","TextReader","reader","getEntries","entries","length","i","getData","TextWriter","filename","close","then","parse","body","query","div","document","createElement","classList","add","extract","parentDom","tagName","para","p","getDom","appendChild","r","t","createTextNode","text","tab","tbl","tr","td","setAttribute","queryAttr","ppr","getNumbering","pre","Prop","styles","numbering","counter","numpr","sid","style","ilvl","numid","num","abstractNumId","abstractNum","lvl","start","numfmt","undefined","parseInt","lvlText","lvlOverride","replace","match","p1","Paragraph","docNode","BaseTag"],"mappings":"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","file":"docx-parser.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 21a4b80348fd3e780749","class XML {\n  constructor(data) {\n    if (data instanceof Node) {\n      this.data = data;\n    } else if (typeof data  === 'string') {\n      let oParser = new DOMParser();\n      let oDOM = oParser.parseFromString(data, \"text/xml\");\n      this.data = oDOM.documentElement;\n    } else {\n      throw new Error('error create XML');\n    }\n  }\n\n  query(selector) {\n    let el = this.data.querySelector(selector);\n    if (el) {\n      return new XML(el);\n    }\n    return null;\n  }\n\n  queryAll(selector) {\n    let nodes = this.data.querySelectorAll(selector);\n    let result = [];\n    for (let item of nodes) {\n      result.push(new XML(item));\n    }\n    return result;\n  }\n\n  queryAttr(selector) {\n    let [s, a] = selector.split('@');\n    let node = this.data;\n    if (s) {\n      node = node.querySelector(s);\n    }\n    if (node) {\n      return node.getAttribute('w:' + a);\n    }\n    return null;\n  }\n\n  get children() {\n    let nodes = this.data.children;\n    let result = [];\n    for (let item of nodes) {\n      result.push(new XML(item));\n    }\n    return result;\n  }\n\n  get tagName() {\n    return this.data.localName;\n  }\n\n  get text() {\n    return this.data.textContent;\n  }\n}\n\nexport { XML };\n\n\n\n// WEBPACK FOOTER //\n// ./src/XML.js","import { load } from './Reader.js';\nwindow.docxparser = { load: load };\n\n\n\n// WEBPACK FOOTER //\n// ./src/docx-parser.js","import { XML } from './XML';\nimport { Prop } from './Prop';\n\nimport Paragraph from './tags/Paragraph';\n\nlet files = {}; // all files in zip\nlet prop;\n\nfunction load(file) {\n  let promise = new Promise((resolve, reject) => {\n    zip.createReader(new zip.TextReader(file), reader => {\n      // get all entries from the zip\n      reader.getEntries(entries => {\n        if (entries.length) {\n          for (let i = entries.length - 1; i >= 0; i--) {\n            entries[i].getData(new zip.TextWriter(), data => {\n              files[entries[i].filename] = data;\n              if (i === 0) {\n                resolve();\n                reader.close();\n              }\n            });\n          }\n        }\n      });\n    }, error => {\n      reject('read file error');\n    });\n  });\n\n  return promise.then(() => {\n    if (!files['word/document.xml']) {\n      throw new Error('invalid docx file.');\n    }\n    return parse();\n  });\n}\n\nfunction parse() {\n  let data = files['word/document.xml'];\n  if (files['word/styles.xml'] && files['word/numbering.xml']) {\n    prop = new Prop(files['word/styles.xml'], files['word/numbering.xml']);\n  }\n\n  let body = (new XML(data)).query('body');\n  let div = document.createElement('div');\n  div.classList.add('doc');\n  extract(body, div);\n  return div;\n}\n\nfunction extract(el, parentDom) {\n  for (let item of el.children) {\n    switch (item.tagName) {\n      case 'p':\n        let para = new Paragraph(item, prop);\n        let p = para.getDom();\n        parentDom.appendChild(p);\n        extract(item, p);\n        break;\n      case 'r':\n      case 'hyperlink':\n        let r = document.createElement('pre');\n        parentDom.appendChild(r);\n        extract(item, r);\n        break;\n      case 't':\n        let t = document.createTextNode(item.text);\n        parentDom.appendChild(t);\n        break;\n      case 'tab':\n        let tab = document.createTextNode('\\t');\n        parentDom.appendChild(tab);\n        break;\n      case 'tbl':\n        let tbl = document.createElement('table');\n        parentDom.appendChild(tbl);\n        extract(item, tbl);\n        break;\n      case 'tr':\n        let tr = document.createElement('tr');\n        parentDom.appendChild(tr);\n        extract(item, tr);\n        break;\n      case 'tc':\n        let td = document.createElement('td');\n        td.setAttribute('colspan', item.queryAttr(':scope>tcPr>gridSpan@val'));\n        parentDom.appendChild(td);\n        extract(item, td);\n        break;\n    }\n  }\n}\n\n/**\n * evaluate styles and numbering\n */\nfunction ppr(node, el) {\n  if (!prop) {\n    return;\n  }\n  // deal numbering\n  let i = prop.getNumbering(node);\n  if (i) {\n    let pre = document.createElement('pre');\n    pre.appendChild(document.createTextNode(i));\n    el.appendChild(pre);\n  }\n}\n\nexport { load };\n\n\n\n// WEBPACK FOOTER //\n// ./src/Reader.js","import { XML } from './XML';\n\nclass Prop {\n  constructor(styles, numbering) {\n    this.styles = new XML(styles);\n    this.numbering = new XML(numbering);\n    this.counter = {};\n  }\n\n  getNumbering(node) {\n    let numpr = node.query(':scope>pPr>numPr');\n    if (!numpr) {\n      let sid = node.queryAttr(':scope>pPr>pStyle@val');\n      if (!sid) {\n        return;\n      }\n      let style = this.styles.query('style[*|styleId=\"' + sid + '\"]');\n      numpr = style.query(':scope>pPr>numPr');\n    }\n    if (!numpr) {\n      return;\n    }\n\n    let ilvl = numpr.queryAttr('ilvl@val') || '0';\n    let numid = numpr.queryAttr('numId@val');\n\n    let num = this.numbering.query('num[*|numId=\"' + numid + '\"]');\n\n    if (!num) {\n      return;\n    }\n\n    let abstractNumId = num.queryAttr('abstractNumId@val');\n\n    if (!this.counter[abstractNumId]) {\n      this.counter[abstractNumId] = {};\n    }\n\n    let abstractNum = this.numbering.query('abstractNum[*|abstractNumId=\"' + abstractNumId + '\"]');\n\n    let lvl = abstractNum.query('lvl[*|ilvl=\"' + ilvl + '\"]');\n    let start = lvl.queryAttr('start@val');\n\n    let numfmt = lvl.queryAttr('numFmt@val');\n    if (numfmt === 'none') {\n      return;\n    }\n    if (numfmt === 'bullet') {\n      return '\\u2022 ';\n    }\n\n    this.counter[abstractNumId][ilvl] =\n      this.counter[abstractNumId][ilvl] === undefined ? parseInt(start) : this.counter[abstractNumId][ilvl] + 1;\n\n    for (let i in this.counter[abstractNumId]) {\n      if (parseInt(i) > parseInt(ilvl)) {\n        delete this.counter[abstractNumId][i];\n      }\n    }\n\n    let lvlText = lvl.queryAttr('lvlText@val');\n    let lvlOverride = num.query('lvlOverride[*|ilvl=\"' + ilvl + '\"]');\n    if (lvlOverride) {\n      this.counter[abstractNumId][ilvl] = parseInt(lvlOverride.queryAttr('startOverride@val'));\n    }\n    lvlText = lvlText.replace(/%(\\d)/g, (match, p1) => {\n      if (parseInt(p1) === parseInt(ilvl) + 1) {\n        return this.counter[abstractNumId][ilvl];\n      }\n      if (parseInt(p1) <= parseInt(ilvl)) {\n        return this.counter[abstractNumId][parseInt(p1) - 1 + ''];\n      }\n      return '';\n    });\n\n    return lvlText + ' ';\n  }\n}\n\nexport { Prop };\n\n\n\n// WEBPACK FOOTER //\n// ./src/Prop.js","import BaseTag from './BaseTag';\n\nexport default class Paragraph extends BaseTag {\n  getDom() {\n    let p = document.createElement('p');\n    if (this.prop) {\n      // deal numbering\n      let i = this.prop.getNumbering(this.docNode);\n      if (i) {\n        let pre = document.createElement('pre');\n        pre.appendChild(document.createTextNode(i));\n        p.appendChild(pre);\n      }\n    }\n\n    return p;\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tags/Paragraph.js","export default class BaseTag {\n  constructor(docNode, prop) {\n    this.docNode = docNode;\n    this.prop = prop;\n  }\n\n  getDom() {\n    throw new Error('Do not use the super class of tags.');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/tags/BaseTag.js"],"sourceRoot":""}